/var/runtime/botocore/vendored/requests/__init__.py:91: RequestsDependencyWarning: urllib3 (1.26.4) or chardet (4.0.0) doesn't match a supported version!
RequestsDependencyWarning)
START RequestId: XXXX Version: $LATEST
{"m": "aws.lambda.enhanced.invocations", "v": 1, "e": XXXX, "t": ["region:us-east-1", "account_id:XXXX", "functionname:integration-dev-http-requests_python37", "resource:integration-dev-http-requests_python37", "cold_start:true", "memorysize:1024", "runtime:python3.7", "datadog_lambda:vXX", "dd_lambda_layer:datadog-python37_2.XX.0"]}
HTTP GET https://ip-ranges.datadoghq.com/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
HTTP GET https://ip-ranges.datadoghq.eu/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
2021-03-24 18:59:35.230 (-04:00)	19362f9b-a840-4369-aed6-b6adfae317fa	[ERROR]	[dd.trace_id=2554114758548432857 dd.span_id=17709355450657236365]	Error flushing metrics and events
Traceback (most recent call last):
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/base.py", line 343, in flush
self.reporter.flush_distributions(dists)
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/reporters.py", line 24, in flush_distributions
api.Distribution.send(distributions, compress_payload=self.compress_payload)
File "/opt/python/lib/python3.7/site-packages/datadog/api/distributions.py", line 43, in send
attach_host_name=attach_host_name, compress_payload=compress_payload, **series_dict
File "/opt/python/lib/python3.7/site-packages/datadog/api/resources.py", line 88, in send
compress_payload=compress_payload
File "/opt/python/lib/python3.7/site-packages/datadog/api/api_client.py", line 166, in submit
proxies=_proxies, verify=_cacert
File "/opt/python/lib/python3.7/site-packages/datadog/api/http_client.py", line 100, in request
proxies=proxies, verify=verify)
File "/opt/python/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
resp = self.send(prep, **send_kwargs)
File "/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py", line 95, in _wrap_send
response = func(*args, **kwargs)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 133, in _log_request
_print_request_string(request)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 147, in _print_request_string
data_dict = json.loads(data)
File "/var/lang/lib/python3.7/json/__init__.py", line 343, in loads
s = s.decode(detect_encoding(s), 'surrogatepass')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte
{"traces": [[{"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "integration-dev-http-requests_python37", "name": "aws.lambda", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "runtime-id": "XXXX", "cold_start": "true", "function_arn": "arn:aws:lambda:us-east-1:601427279990:function:integration-dev-http-requests_python37", "function_version": "$LATEST", "request_id": "XXXX", "resource_names": "integration-dev-http-requests_python37", "datadog_lambda": "X.X.X", "dd_trace": "X.X.X", "function_trigger.event_source": "api-gateway", "function_trigger.event_source_arn": "arn:aws:apigateway:us-east-1::/restapis/wt6mne2s9k/stages/test", "http.method": "GET", "http.status_code": "200"}, "metrics": {"_dd.agent_psr": 1.0, "system.pid": XXXX, "_sampling_priority_v1": 1}, "type": "serverless"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.com/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.eu/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 1, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "POST", "http.url": "https://api.datadoghq.com/api/v1/distribution_points", "error.msg": "'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte", "error.type": "builtins.UnicodeDecodeError", "error.stack": "Traceback (most recent call last):\n  File \"/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py\", line 95, in _wrap_send\n    response = func(*args, **kwargs)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 133, in _log_request\n    _print_request_string(request)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 147, in _print_request_string\n    data_dict = json.loads(data)\n  File \"/var/lang/lib/python3.7/json/__init__.py\", line 343, in loads\n    s = s.decode(detect_encoding(s), 'surrogatepass')\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte\n"}, "metrics": {"_dd.measured": 1}, "type": "http"}]]}
END RequestId: XXXX
REPORT RequestId: XXXX	Duration: XXXX ms	Billed Duration: XXXX ms	Memory Size: 1024 MB	Max Memory Used: XXXX MB	Init Duration: XXXX ms	
XRAY TraceId: XXXX	SegmentId: XXXX	Sampled: true	
START RequestId: XXXX Version: $LATEST
{"m": "aws.lambda.enhanced.invocations", "v": 1, "e": XXXX, "t": ["region:us-east-1", "account_id:XXXX", "functionname:integration-dev-http-requests_python37", "resource:integration-dev-http-requests_python37", "cold_start:false", "memorysize:1024", "runtime:python3.7", "datadog_lambda:vXX", "dd_lambda_layer:datadog-python37_2.XX.0"]}
HTTP GET https://ip-ranges.datadoghq.com/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
HTTP GET https://ip-ranges.datadoghq.eu/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
2021-03-24 18:59:36.473 (-04:00)	3e008ae8-1fc1-42eb-981f-cba673b91fe8	[ERROR]	[dd.trace_id=4791579365381194797 dd.span_id=7058829388885120006]	Error flushing metrics and events
Traceback (most recent call last):
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/base.py", line 343, in flush
self.reporter.flush_distributions(dists)
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/reporters.py", line 24, in flush_distributions
api.Distribution.send(distributions, compress_payload=self.compress_payload)
File "/opt/python/lib/python3.7/site-packages/datadog/api/distributions.py", line 43, in send
attach_host_name=attach_host_name, compress_payload=compress_payload, **series_dict
File "/opt/python/lib/python3.7/site-packages/datadog/api/resources.py", line 88, in send
compress_payload=compress_payload
File "/opt/python/lib/python3.7/site-packages/datadog/api/api_client.py", line 166, in submit
proxies=_proxies, verify=_cacert
File "/opt/python/lib/python3.7/site-packages/datadog/api/http_client.py", line 100, in request
proxies=proxies, verify=verify)
File "/opt/python/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
resp = self.send(prep, **send_kwargs)
File "/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py", line 95, in _wrap_send
response = func(*args, **kwargs)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 133, in _log_request
_print_request_string(request)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 147, in _print_request_string
data_dict = json.loads(data)
File "/var/lang/lib/python3.7/json/__init__.py", line 343, in loads
s = s.decode(detect_encoding(s), 'surrogatepass')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte
{"traces": [[{"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "integration-dev-http-requests_python37", "name": "aws.lambda", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "runtime-id": "XXXX", "cold_start": "false", "function_arn": "arn:aws:lambda:us-east-1:601427279990:function:integration-dev-http-requests_python37", "function_version": "$LATEST", "request_id": "XXXX", "resource_names": "integration-dev-http-requests_python37", "datadog_lambda": "X.X.X", "dd_trace": "X.X.X", "function_trigger.event_source": "sns", "function_trigger.event_source_arn": "arn:aws:sns:us-east-2:123456789012:sns-lambda"}, "metrics": {"_dd.agent_psr": 1.0, "system.pid": XXXX, "_sampling_priority_v1": 1}, "type": "serverless"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.com/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.eu/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 1, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "POST", "http.url": "https://api.datadoghq.com/api/v1/distribution_points", "error.msg": "'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte", "error.type": "builtins.UnicodeDecodeError", "error.stack": "Traceback (most recent call last):\n  File \"/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py\", line 95, in _wrap_send\n    response = func(*args, **kwargs)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 133, in _log_request\n    _print_request_string(request)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 147, in _print_request_string\n    data_dict = json.loads(data)\n  File \"/var/lang/lib/python3.7/json/__init__.py\", line 343, in loads\n    s = s.decode(detect_encoding(s), 'surrogatepass')\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte\n"}, "metrics": {"_dd.measured": 1}, "type": "http"}]]}
END RequestId: XXXX
REPORT RequestId: XXXX	Duration: XXXX ms	Billed Duration: XXXX ms	Memory Size: 1024 MB	Max Memory Used: XXXX MB	
XRAY TraceId: XXXX	SegmentId: XXXX	Sampled: true	
START RequestId: XXXX Version: $LATEST
{"m": "aws.lambda.enhanced.invocations", "v": 1, "e": XXXX, "t": ["region:us-east-1", "account_id:XXXX", "functionname:integration-dev-http-requests_python37", "resource:integration-dev-http-requests_python37", "cold_start:false", "memorysize:1024", "runtime:python3.7", "datadog_lambda:vXX", "dd_lambda_layer:datadog-python37_2.XX.0"]}
HTTP GET https://ip-ranges.datadoghq.com/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
HTTP GET https://ip-ranges.datadoghq.eu/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
2021-03-24 18:59:38.130 (-04:00)	3648a23b-6ca7-4e69-8847-34825f317192	[ERROR]	[dd.trace_id=666 dd.span_id=2089548463559446525]	Error flushing metrics and events
Traceback (most recent call last):
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/base.py", line 343, in flush
self.reporter.flush_distributions(dists)
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/reporters.py", line 24, in flush_distributions
api.Distribution.send(distributions, compress_payload=self.compress_payload)
File "/opt/python/lib/python3.7/site-packages/datadog/api/distributions.py", line 43, in send
attach_host_name=attach_host_name, compress_payload=compress_payload, **series_dict
File "/opt/python/lib/python3.7/site-packages/datadog/api/resources.py", line 88, in send
compress_payload=compress_payload
File "/opt/python/lib/python3.7/site-packages/datadog/api/api_client.py", line 166, in submit
proxies=_proxies, verify=_cacert
File "/opt/python/lib/python3.7/site-packages/datadog/api/http_client.py", line 100, in request
proxies=proxies, verify=verify)
File "/opt/python/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
resp = self.send(prep, **send_kwargs)
File "/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py", line 95, in _wrap_send
response = func(*args, **kwargs)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 133, in _log_request
_print_request_string(request)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 147, in _print_request_string
data_dict = json.loads(data)
File "/var/lang/lib/python3.7/json/__init__.py", line 343, in loads
s = s.decode(detect_encoding(s), 'surrogatepass')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte
{"traces": [[{"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "integration-dev-http-requests_python37", "name": "aws.lambda", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "runtime-id": "XXXX", "cold_start": "false", "function_arn": "arn:aws:lambda:us-east-1:601427279990:function:integration-dev-http-requests_python37", "function_version": "$LATEST", "request_id": "XXXX", "resource_names": "integration-dev-http-requests_python37", "datadog_lambda": "X.X.X", "dd_trace": "X.X.X", "function_trigger.event_source": "sqs", "function_trigger.event_source_arn": "arn:aws:sqs:us-east-2:123456789012:my-queue"}, "metrics": {"system.pid": XXXX, "_sampling_priority_v1": 1}, "type": "serverless"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.com/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.eu/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 1, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "POST", "http.url": "https://api.datadoghq.com/api/v1/distribution_points", "error.msg": "'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte", "error.type": "builtins.UnicodeDecodeError", "error.stack": "Traceback (most recent call last):\n  File \"/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py\", line 95, in _wrap_send\n    response = func(*args, **kwargs)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 133, in _log_request\n    _print_request_string(request)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 147, in _print_request_string\n    data_dict = json.loads(data)\n  File \"/var/lang/lib/python3.7/json/__init__.py\", line 343, in loads\n    s = s.decode(detect_encoding(s), 'surrogatepass')\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte\n"}, "metrics": {"_dd.measured": 1}, "type": "http"}]]}
END RequestId: XXXX
REPORT RequestId: XXXX	Duration: XXXX ms	Billed Duration: XXXX ms	Memory Size: 1024 MB	Max Memory Used: XXXX MB	
XRAY TraceId: XXXX	SegmentId: XXXX	Sampled: true	
/var/runtime/botocore/vendored/requests/__init__.py:91: RequestsDependencyWarning: urllib3 (1.26.4) or chardet (4.0.0) doesn't match a supported version!
RequestsDependencyWarning)
START RequestId: XXXX Version: $LATEST
{"m": "aws.lambda.enhanced.invocations", "v": 1, "e": XXXX, "t": ["region:us-east-1", "account_id:XXXX", "functionname:integration-dev-http-requests_python37", "resource:integration-dev-http-requests_python37", "cold_start:true", "memorysize:1024", "runtime:python3.7", "datadog_lambda:vXX", "dd_lambda_layer:datadog-python37_2.XX.0"]}
HTTP GET https://ip-ranges.datadoghq.com/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
HTTP GET https://ip-ranges.datadoghq.eu/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
2021-03-24 19:21:10.306 (-04:00)	cb5459fe-053c-408b-ba59-5cb21c6cf0e4	[ERROR]	[dd.trace_id=9544434075676781298 dd.span_id=6741419624821259055]	Error flushing metrics and events
Traceback (most recent call last):
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/base.py", line 343, in flush
self.reporter.flush_distributions(dists)
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/reporters.py", line 24, in flush_distributions
api.Distribution.send(distributions, compress_payload=self.compress_payload)
File "/opt/python/lib/python3.7/site-packages/datadog/api/distributions.py", line 43, in send
attach_host_name=attach_host_name, compress_payload=compress_payload, **series_dict
File "/opt/python/lib/python3.7/site-packages/datadog/api/resources.py", line 88, in send
compress_payload=compress_payload
File "/opt/python/lib/python3.7/site-packages/datadog/api/api_client.py", line 166, in submit
proxies=_proxies, verify=_cacert
File "/opt/python/lib/python3.7/site-packages/datadog/api/http_client.py", line 100, in request
proxies=proxies, verify=verify)
File "/opt/python/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
resp = self.send(prep, **send_kwargs)
File "/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py", line 95, in _wrap_send
response = func(*args, **kwargs)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 133, in _log_request
_print_request_string(request)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 147, in _print_request_string
data_dict = json.loads(data)
File "/var/lang/lib/python3.7/json/__init__.py", line 343, in loads
s = s.decode(detect_encoding(s), 'surrogatepass')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte
{"traces": [[{"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "integration-dev-http-requests_python37", "name": "aws.lambda", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "runtime-id": "XXXX", "cold_start": "true", "function_arn": "arn:aws:lambda:us-east-1:601427279990:function:integration-dev-http-requests_python37", "function_version": "$LATEST", "request_id": "XXXX", "resource_names": "integration-dev-http-requests_python37", "datadog_lambda": "X.X.X", "dd_trace": "X.X.X", "function_trigger.event_source": "api-gateway", "function_trigger.event_source_arn": "arn:aws:apigateway:us-east-1::/restapis/wt6mne2s9k/stages/test", "http.method": "GET", "http.status_code": "200"}, "metrics": {"_dd.agent_psr": 1.0, "system.pid": XXXX, "_sampling_priority_v1": 1}, "type": "serverless"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.com/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.eu/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 1, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "POST", "http.url": "https://api.datadoghq.com/api/v1/distribution_points", "error.msg": "'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte", "error.type": "builtins.UnicodeDecodeError", "error.stack": "Traceback (most recent call last):\n  File \"/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py\", line 95, in _wrap_send\n    response = func(*args, **kwargs)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 133, in _log_request\n    _print_request_string(request)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 147, in _print_request_string\n    data_dict = json.loads(data)\n  File \"/var/lang/lib/python3.7/json/__init__.py\", line 343, in loads\n    s = s.decode(detect_encoding(s), 'surrogatepass')\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte\n"}, "metrics": {"_dd.measured": 1}, "type": "http"}]]}
END RequestId: XXXX
REPORT RequestId: XXXX	Duration: XXXX ms	Billed Duration: XXXX ms	Memory Size: 1024 MB	Max Memory Used: XXXX MB	Init Duration: XXXX ms	
XRAY TraceId: XXXX	SegmentId: XXXX	Sampled: true	
START RequestId: XXXX Version: $LATEST
{"m": "aws.lambda.enhanced.invocations", "v": 1, "e": XXXX, "t": ["region:us-east-1", "account_id:XXXX", "functionname:integration-dev-http-requests_python37", "resource:integration-dev-http-requests_python37", "cold_start:false", "memorysize:1024", "runtime:python3.7", "datadog_lambda:vXX", "dd_lambda_layer:datadog-python37_2.XX.0"]}
HTTP GET https://ip-ranges.datadoghq.com/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
HTTP GET https://ip-ranges.datadoghq.eu/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
2021-03-24 19:21:11.792 (-04:00)	b5584c13-8cec-4808-80fe-beba9761e4a2	[ERROR]	[dd.trace_id=9926142645871746557 dd.span_id=8394449310204669802]	Error flushing metrics and events
Traceback (most recent call last):
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/base.py", line 343, in flush
self.reporter.flush_distributions(dists)
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/reporters.py", line 24, in flush_distributions
api.Distribution.send(distributions, compress_payload=self.compress_payload)
File "/opt/python/lib/python3.7/site-packages/datadog/api/distributions.py", line 43, in send
attach_host_name=attach_host_name, compress_payload=compress_payload, **series_dict
File "/opt/python/lib/python3.7/site-packages/datadog/api/resources.py", line 88, in send
compress_payload=compress_payload
File "/opt/python/lib/python3.7/site-packages/datadog/api/api_client.py", line 166, in submit
proxies=_proxies, verify=_cacert
File "/opt/python/lib/python3.7/site-packages/datadog/api/http_client.py", line 100, in request
proxies=proxies, verify=verify)
File "/opt/python/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
resp = self.send(prep, **send_kwargs)
File "/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py", line 95, in _wrap_send
response = func(*args, **kwargs)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 133, in _log_request
_print_request_string(request)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 147, in _print_request_string
data_dict = json.loads(data)
File "/var/lang/lib/python3.7/json/__init__.py", line 343, in loads
s = s.decode(detect_encoding(s), 'surrogatepass')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte
{"traces": [[{"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "integration-dev-http-requests_python37", "name": "aws.lambda", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "runtime-id": "XXXX", "cold_start": "false", "function_arn": "arn:aws:lambda:us-east-1:601427279990:function:integration-dev-http-requests_python37", "function_version": "$LATEST", "request_id": "XXXX", "resource_names": "integration-dev-http-requests_python37", "datadog_lambda": "X.X.X", "dd_trace": "X.X.X", "function_trigger.event_source": "sns", "function_trigger.event_source_arn": "arn:aws:sns:us-east-2:123456789012:sns-lambda"}, "metrics": {"_dd.agent_psr": 1.0, "system.pid": XXXX, "_sampling_priority_v1": 1}, "type": "serverless"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.com/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.eu/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 1, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "POST", "http.url": "https://api.datadoghq.com/api/v1/distribution_points", "error.msg": "'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte", "error.type": "builtins.UnicodeDecodeError", "error.stack": "Traceback (most recent call last):\n  File \"/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py\", line 95, in _wrap_send\n    response = func(*args, **kwargs)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 133, in _log_request\n    _print_request_string(request)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 147, in _print_request_string\n    data_dict = json.loads(data)\n  File \"/var/lang/lib/python3.7/json/__init__.py\", line 343, in loads\n    s = s.decode(detect_encoding(s), 'surrogatepass')\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte\n"}, "metrics": {"_dd.measured": 1}, "type": "http"}]]}
END RequestId: XXXX
REPORT RequestId: XXXX	Duration: XXXX ms	Billed Duration: XXXX ms	Memory Size: 1024 MB	Max Memory Used: XXXX MB	
XRAY TraceId: XXXX	SegmentId: XXXX	Sampled: true	
START RequestId: XXXX Version: $LATEST
{"m": "aws.lambda.enhanced.invocations", "v": 1, "e": XXXX, "t": ["region:us-east-1", "account_id:XXXX", "functionname:integration-dev-http-requests_python37", "resource:integration-dev-http-requests_python37", "cold_start:false", "memorysize:1024", "runtime:python3.7", "datadog_lambda:vXX", "dd_lambda_layer:datadog-python37_2.XX.0"]}
HTTP GET https://ip-ranges.datadoghq.com/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
HTTP GET https://ip-ranges.datadoghq.eu/ Headers: ["Accept-Encoding:gzip, deflate", "Accept:*/*", "Connection:keep-alive", "User-Agent:python-requests/2.25.1", "x-datadog-parent-id:XXXX", "x-datadog-sampling-priority:1", "x-datadog-trace-id:XXXX"] Data: {}
2021-03-24 19:21:13.196 (-04:00)	b33cc004-5814-4adf-a2ea-8da303b64d6c	[ERROR]	[dd.trace_id=666 dd.span_id=4677605157232014830]	Error flushing metrics and events
Traceback (most recent call last):
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/base.py", line 343, in flush
self.reporter.flush_distributions(dists)
File "/opt/python/lib/python3.7/site-packages/datadog/threadstats/reporters.py", line 24, in flush_distributions
api.Distribution.send(distributions, compress_payload=self.compress_payload)
File "/opt/python/lib/python3.7/site-packages/datadog/api/distributions.py", line 43, in send
attach_host_name=attach_host_name, compress_payload=compress_payload, **series_dict
File "/opt/python/lib/python3.7/site-packages/datadog/api/resources.py", line 88, in send
compress_payload=compress_payload
File "/opt/python/lib/python3.7/site-packages/datadog/api/api_client.py", line 166, in submit
proxies=_proxies, verify=_cacert
File "/opt/python/lib/python3.7/site-packages/datadog/api/http_client.py", line 100, in request
proxies=proxies, verify=verify)
File "/opt/python/lib/python3.7/site-packages/requests/sessions.py", line 542, in request
resp = self.send(prep, **send_kwargs)
File "/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py", line 95, in _wrap_send
response = func(*args, **kwargs)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 133, in _log_request
_print_request_string(request)
File "/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py", line 147, in _print_request_string
data_dict = json.loads(data)
File "/var/lang/lib/python3.7/json/__init__.py", line 343, in loads
s = s.decode(detect_encoding(s), 'surrogatepass')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte
{"traces": [[{"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "integration-dev-http-requests_python37", "name": "aws.lambda", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "runtime-id": "XXXX", "cold_start": "false", "function_arn": "arn:aws:lambda:us-east-1:601427279990:function:integration-dev-http-requests_python37", "function_version": "$LATEST", "request_id": "XXXX", "resource_names": "integration-dev-http-requests_python37", "datadog_lambda": "X.X.X", "dd_trace": "X.X.X", "function_trigger.event_source": "sqs", "function_trigger.event_source_arn": "arn:aws:sqs:us-east-2:123456789012:my-queue"}, "metrics": {"system.pid": XXXX, "_sampling_priority_v1": 1}, "type": "serverless"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.com/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 0, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "GET", "http.url": "https://ip-ranges.datadoghq.eu/", "http.status_code": "200"}, "metrics": {"_dd.measured": 1}, "type": "http"}, {"trace_id": "XXXX", "parent_id": "XXXX", "span_id": "XXXX", "service": "aws.lambda", "resource": "requests.request", "name": "requests.request", "error": 1, "start": XXXX, "duration": XXXX, "meta": {"_dd.origin": "lambda", "http.method": "POST", "http.url": "https://api.datadoghq.com/api/v1/distribution_points", "error.msg": "'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte", "error.type": "builtins.UnicodeDecodeError", "error.stack": "Traceback (most recent call last):\n  File \"/opt/python/lib/python3.7/site-packages/ddtrace/contrib/requests/connection.py\", line 95, in _wrap_send\n    response = func(*args, **kwargs)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 133, in _log_request\n    _print_request_string(request)\n  File \"/opt/python/lib/python3.7/site-packages/datadog_lambda/patch.py\", line 147, in _print_request_string\n    data_dict = json.loads(data)\n  File \"/var/lang/lib/python3.7/json/__init__.py\", line 343, in loads\n    s = s.decode(detect_encoding(s), 'surrogatepass')\nUnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 1: invalid start byte\n"}, "metrics": {"_dd.measured": 1}, "type": "http"}]]}
END RequestId: XXXX
REPORT RequestId: XXXX	Duration: XXXX ms	Billed Duration: XXXX ms	Memory Size: 1024 MB	Max Memory Used: XXXX MB	
XRAY TraceId: XXXX	SegmentId: XXXX	Sampled: true	
